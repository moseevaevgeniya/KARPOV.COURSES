## Проект-6: Поиск аномалий. Система алертов.

### 1. Наша задача:

**Написать систему алертов для нашего приложения VK.**  

-  Система должна с периодичность каждые 15 минут проверять ключевые метрики, такие как активные пользователи в ленте / мессенджере, просмотры, лайки, CTR, количество отправленных сообщений.  
- Изучить поведение метрик и подобрать наиболее подходящий метод для детектирования аномалий. На практике как правило применяются статистические методы. В самом простом случае можно, например, проверять отклонение значения метрики в текущую 15-минутку от значения в такую же 15-минутку день назад.  
- В случае обнаружения аномального значения, в чат должен отправиться алерт - сообщение со следующей информацией: метрика, ее значение, величина отклонения.  
- В сообщение можно добавить дополнительную информацию, которая поможет при исследовании причин возникновения аномалии, это может быть, например,  график, ссылки на дашборд/чарт в BI системе.  
- Пример шаблона алерта:  
Метрика {metric_name} в срезе {group}.  
Текущее значение {current_x}. Отклонение более {x}%.  
[опционально: ссылка на риалтайм чарт этой метрики в BI для более гибкого просмотра]  
[опционально: ссылка на риалтайм дашборд в BI для исследования ситуации в целом]  
@[опционально: тегаем ответственного/наиболее заинтересованного человека в случае отклонения конкретно  
этой метрики в этом срезе (если такой человек есть)]  
[график]  


- Автоматизировать систему алертов с помощью Airflow.  


### 2. Вот что у нас получилось:

- [Сисема алертов.py](https://github.com/moseevaevgeniya/Project_in_Karpov.courses/blob/4aaf0c126e6eded5f954706e08684ba0a3485a8c/6.%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82:%20%D0%9F%D0%BE%D0%B8%D1%81%D0%BA%20%D0%B0%D0%BD%D0%BE%D0%BC%D0%B0%D0%BB%D0%B8%D0%B9.%20%D0%A1%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0%20%D0%B0%D0%BB%D0%B5%D1%80%D1%82%D0%BE%D0%B2./task_7_alert_dag__1_.py)

### 3. Автоматизировали систему алертов с помощью Airflow, для этого:  

- Клонировали репозиторий  
- В локальной копии внутри папки dags создали свою папку — она должна совпадать по названию с моим именем пользователя, которое через @ в профиле GitLab  
- Создали там DAG — он должен быть в файле с форматом .py  
- Запушивали результат (не забыть подтянуть все свежие изменения, чтобы не удалить папки своих коллег!)  
- Включили DAG, когда он появился в Airflow  


### 4. Теги:  

- ClickHouse  
- SQL Lab  
- JUPYTERHUB  
- Redash  
- Airflow  
- Python  
- библиотеки: pandas, pandahouse, datetime, timedelta, numpy, telegram, matplotlib.pyplot, seaborn, io,  
- для создания DAG-а и его «содержания»: airflow, DAG,task,  airflow.operators.python_operator, PythonOperator, datetime, airflow.decorators, get_current_context  
